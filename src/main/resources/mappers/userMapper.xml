<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.freehoon.web.user.userMapper">

	<select id="getUserListCnt" resultType="int">

		SELECT

		count(*) as listCnt

		FROM

		personal_profile

		<trim prefix="WHERE" prefixOverrides="AND|OR">

			<if
				test="searchType=='name' and keyword != null and keyword != '' ">

				AND name like CONCAT('%', #{keyword}, '%')

			</if>

			<if
				test="searchType=='DEPARTMENT' and keyword != null and keyword != '' ">

				AND DEPARTMENT like CONCAT('%', #{keyword}, '%')

			</if>

		</trim>

	</select>


	<select id="LoginProcess"
		resultType="com.freehoon.web.login.model.LoginVO">

		SELECT
		name, identifier, uid, ID_CARD_SERIAL

		FROM
		TBL_USER

		WHERE
		1=1
		AND uid = #{uid}
		AND pwd = #{pwd}

	</select>

	<select id="IDCheck"
		resultType="com.freehoon.web.profile.model.ProfileVO">

		SELECT
		uid, name

		FROM
		TBL_USER

		WHERE
		1=1
		AND uid = #{ID_CARD_SERIAL}

	</select>

	<select id="getUserList"
		resultType="com.freehoon.web.profile.model.ProfileVO">

		SELECT
		LEVEL, STATUS, NAME, DEPARTMENT, POSITION, TELEP_HONE, HAND_PHONE, EMAIL,
		WOR_KDATE, identifier

		FROM
		personal_profile
		<trim prefix="WHERE" prefixOverrides="AND|OR">

			<if
				test="searchType=='name' and keyword != null and keyword != '' ">

				AND name like CONCAT('%', #{keyword}, '%')

			</if>

			<if
				test="searchType=='DEPARTMENT' and keyword != null and keyword != '' ">

				AND DEPARTMENT like CONCAT('%', #{keyword}, '%')

			</if>

		</trim>

		LIMIT #{startList}, #{listSize}

	</select>


	<insert id="insertUser"
		parameterType="com.freehoon.web.login.model.IDVO">
		INSERT INTO
		TBL_USER (ID_CARD_SERIAL, uid, name, pwd,
		reg_date, identifier)
		VALUES
		(#{ID_CARD_SERIAL}, #{uid}, #{name}, #{pwd}
		, now(),#{identifier})

	</insert>


	<update id="updateUser"
		parameterType="com.freehoon.web.login.model.IDVO">

		UPDATE TBL_USER 
		SET 
		PWD = #{pwd} 
		WHERE uid = #{uid}
		
	</update>


</mapper>


